---
title: "자바에서의 불변성"
excerpt: "put메소드를 개발하며 불변성에 대한 의사결정"

categories:
  - Web
tags:
  - [Web,HTTP]

permalink: /web/http-idempodent/

toc: true
toc_sticky: true

date: 2022-06-09
last_modified_at: 2022-06-09
published: true
---

## 글을 쓰는 계기
codesoom 1차 과제인 todo API를 만드는 도중 PUT을 구현하는 과정에서 불변성에 대해 고민하게 되었다. 새로운 객체를 만들어 기존의 객체를 대체하는 것이 좋은 방법일지, 기존의 객체를 그대로 두되, 내용의 일부만 수정하는 것이 좋은 방법일지에 대해 고민했다. 

## PUT
**HTTP PUT 메서드는 요청 페이로드를 사용해 새로운 리소스를 생성하거나, 대상 리소스를 나타내는 데이터를 대체합니다.**

put은 대상 리소스를 대체한다고 되어 있다. 그러나 두가지 방법 모두 말이 된다. 전자는 객체를 대체하는 것이고, 후자는 데이터를 대체하는 것이다. 

## 불변성의 장점
불변성을 고려한 이유가 무엇일까? 불변성을 지키면
 - 상태변화를 쉽게 추적할 수 있고, 관리할 수 있다. 
- 개발자가 예상하지 못한 사이드이펙트를 방지할 수 있다. 
- 멀티쓰레딩을 할 때 유용하다. 
그러나 불변성은 주로 함수형 프로그래밍에서 많이 사용되는 용어이다. 객체지향 프로그래밍에서는 불변성과의 접점을 만들기 어렵다. 

## 함수형 프로그래밍과 객체지향 프로그래밍의 차이

객체지향에서의 객체는 자바스크립트의 object처럼 단순히 프로퍼티가 아니다. 만약 객체가 가지고 있는 멤버 변수와 메소드가 많거나 객체를 생성할 때 무거운 작업이 동반되어야 한다면, 프로퍼티를 변경할 때마다 객체를 생성하는 것은 퍼포먼스에 상당한 부담이 될 수도 있다. 

## 불변성에 대한 결론

현재 나의 코드에선 불변성을 지켰을 때 생기는 장점 중 해당하는 것이 크게 없다. 
- 현재 task들을 다른 곳에서 사용하지 않고 있고, 간단한 CRUD만 있는 상황에서 사이드이펙트가 발생할 부분은 없어보인다.
- 또한 task객체를 수정하는 부분은 put task 밖에 없어 상태변화를 추적하는 데 어려움이 있지 않다. 

반면 단점은 뚜렷하다.
- 불필요한 객체를 생성한다. gc가 있지만, 불필요한 객체를 계속해서 생성하는 것은 좋지 않다.
- 기존의 객체를 지우고, 새로운 객체를 만들어 할당해야 하므로 코드가 복잡해진다. 

불변성을 적용하는 것은 객체지향 프로그래밍에선 장점을 발휘하기 어려운 부분이 있는 것 같다. 자바스크립트에서 객체와 자바에서 객체가 다르고, 각각이 지향하는 프로그래밍 방식이 다르다는 점에서 불변성의 장점도 바뀌는 것 같다.

## 느낀점
 객체지향 프로그래밍에 대해 조금더 이해도가 높아지는 것 같다. 뿐만 아니라 자바와 자바스크립트의 차이점을 알게되면서 자바스크립트에 대한 이해도도 같이 높아진 것 같다.
